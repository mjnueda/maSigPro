<html><head><title>Wrapping function for identifying significant differential gene expression profiles in micorarray time course experiments</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>maSigPro(maSigPro)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   maSigPro">
<param name="keyword" value=" Wrapping function for identifying significant differential gene expression profiles in micorarray time course experiments">
</object>


<h2>Wrapping function for identifying significant differential gene expression profiles in micorarray time course experiments</h2>


<h3>Description</h3>

<p>
<code>maSigPro</code> performs a whole maSigPro analysis for a times series gene expression experiment.
The function sucesively calls the functions <code><a href="make.design.matrix.html">make.design.matrix</a></code>(optional), <code><a href="p.vector.html">p.vector</a></code>, <code><a href="T.fit.html">T.fit</a></code>,
<code><a href="get.siggenes.html">get.siggenes</a></code> and <code><a href="see.genes.html">see.genes</a></code>.
</p>


<h3>Usage</h3>

<pre>
maSigPro(data, edesign, matrix = "AUTO", groups.vector = NULL, degree = 2, 
         time.col = 1, repl.col = 2, group.cols = c(3:ncol(edesign)), 
         Q = 0.01, alfa = Q, step.method = "backward", rsq = 0.7, min.obs = 3, 
         vars = "groups", cluster.data = 1, add.IDs = FALSE, IDs = NULL, 
         matchID.col = 1, only.names = FALSE, k = 9, cluster.method = "kmeans", 
         distance = "cor", agglo.method = "complete", iter.max = 500, 
         trat.repl.spots = "none", index = IDs[, (matchID.col + 1)], 
         match = IDs[, matchID.col], rs = 0.7, show.fit = TRUE, show.lines = TRUE, 
         pdf = TRUE, cexlab = 0.8, legend = TRUE, main = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
matrix with normalized gene expression data. Genes must be in rows and arrays in columns. Row names must contain geneIDs
newline quad  (argument of <code><a href="p.vector.html">p.vector</a></code>)</td></tr>
<tr valign="top"><td><code>edesign</code></td>
<td>
matrix of experimental design. Row names must contain arrayIDs
newline quad      (argument of <code><a href="make.design.matrix.html">make.design.matrix</a></code> and <code><a href="see.genes.html">see.genes</a></code>)</td></tr>
<tr valign="top"><td><code>matrix</code></td>
<td>
design matrix for regression analysis. By default design is calculated with make.design.matrix
newline quad     (argument of <code><a href="p.vector.html">p.vector</a></code> and <code><a href="T.fit.html">T.fit</a></code>, by default computed by <code><a href="make.design.matrix.html">make.design.matrix</a></code>)</td></tr>
<tr valign="top"><td><code>groups.vector</code></td>
<td>
vector indicating experimental group of each variable 
newline quad      (argument of <code><a href="get.siggenes.html">get.siggenes</a></code> and <code><a href="see.genes.html">see.genes</a></code>, by default computed by <code><a href="make.design.matrix.html">make.design.matrix</a></code>)</td></tr>
<tr valign="top"><td><code>degree</code></td>
<td>
the degree of the regression fit polynome. <code>degree</code> = 1 returns lineal regression, <code>degree</code> = 2 returns quadratic regression, etc...
newline quad      (argument of <code><a href="make.design.matrix.html">make.design.matrix</a></code>) </td></tr>
<tr valign="top"><td><code>time.col</code></td>
<td>
column in edesign containing time values. Default is first column
newline quad      (argument of <code><a href="make.design.matrix.html">make.design.matrix</a></code> and <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>repl.col</code></td>
<td>
column in edesign containing coding for replicates arrays. Default is second column
newline quad      (argument of <code><a href="make.design.matrix.html">make.design.matrix</a></code> and <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>group.cols</code></td>
<td>
columns in <code>edesign</code> indicating the coding for each group of the experiment (see <code><a href="make.design.matrix.html">make.design.matrix</a></code>)
newline quad      (argument of <code><a href="make.design.matrix.html">make.design.matrix</a></code> and <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>Q</code></td>
<td>
level of false discovery rate (FDR) control
newline quad      (argument of <code><a href="p.vector.html">p.vector</a></code>)</td></tr>
<tr valign="top"><td><code>alfa</code></td>
<td>
significance level used for variable selection in the stepwise regression </td></tr>
<tr valign="top"><td><code>step.method</code></td>
<td>
argument to be passed to the step function. Can be either <code>"backward"</code>, <code>"forward"</code>, <code>"two.ways.backward"</code> or <code>"two.ways.forward"</code> </td></tr>
<tr valign="top"><td><code>min.obs</code></td>
<td>
genes with less than this number of true numerical values will be excluded from the analysis. Default is  3 (minimun value for a quadratic fit) </td></tr>
<tr valign="top"><td><code>rsq</code></td>
<td>
cut-off level at the R-squared value for the stepwise regression fit. Only genes with R-squared greater than <code>rsq</code> are selected </td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
variables for which to extract significant genes
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>)</td></tr>
<tr valign="top"><td><code>cluster.data</code></td>
<td>
Type of data used by the cluster algorithm
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>add.IDs</code></td>
<td>
logical indicating whether to include additional gene id's in the significant genes result 
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>IDs</code></td>
<td>
matrix contaning additional gene id information (required when <code>add.IDs</code> is TRUE)
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>matchID.col</code></td>
<td>
number of matching column in matrix IDs for adding genes ids
newline quad     (argument of<code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>only.names</code></td>
<td>
logical. If TRUE, expression values are ommited in the significant genes result
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
number of clusters 
newline quad(argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>cluster.method</code></td>
<td>
clustering method for data partioning
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>distance</code></td>
<td>
distance measurement function used when <code>cluster.method</code> is <code>"hclust"</code>
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>agglo.method</code></td>
<td>
aggregation method used when <code>cluster.method</code> is "hclust"
newline quad     (argument of <code>see.genes</code>) </td></tr>
<tr valign="top"><td><code>iter.max</code></td>
<td>
number of iterations when <code>cluster.method</code> is <code>"kmeans"</code>
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>trat.repl.spots</code></td>
<td>
treatment givent to replicate spots. Possible values are <code>"none"</code> and <code>"average"</code>
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>index</code></td>
<td>
argument of the <code><a href="average.rows.html">average.rows</a></code> function to use when <code>trat.repl.spots</code> is <code>"average"</code>
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>match</code></td>
<td>
argument of the <code>link{\average.rows}</code> function to use when <code>trat.repl.spots</code> is <code>"average"</code>
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>rs</code></td>
<td>
minimun pearson correlation coefficient for replicated spots profiles to be averaged
newline quad     (argument of <code><a href="get.siggenes.html">get.siggenes</a></code>) </td></tr>
<tr valign="top"><td><code>show.fit</code></td>
<td>
logical indicating whether regression fit curves must be plotted
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>show.lines</code></td>
<td>
logical indicating whether a line must be drawn joining plotted data points for reach group
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>)</td></tr>
<tr valign="top"><td><code>pdf</code></td>
<td>
logical indicating whether a pdf results file must be generated
newline quad     (argument of <code><a href="see.genes.html">see.genes</a></code>)</td></tr>
<tr valign="top"><td><code>cexlab</code></td>
<td>
graphical parameter maginfication to be used for x labels in plotting functions </td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
logical indicating whether legend must be added when plotting profiles 
newline quad (argument of <code><a href="see.genes.html">see.genes</a></code>) </td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
title for pdf results file </td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
other graphical function arguments</td></tr>
</table>

<h3>Details</h3>

<p>
maSigPro finds and display genes with significant profile differences in time series gene expression experiments.
The main, compulsory, input parameters for this function are a matrix of gene expression data (see <code><a href="p.vector.html">p.vector</a></code> for details)
and a matrix describing  experimental design (see <code><a href="make.design.matrix.html">make.design.matrix</a></code> or <code><a href="p.vector.html">p.vector</a></code> for details). In case extended
gene ID information is wanted to be included in the result of significant genes, a third IDs matrix containing this 
information will be required (see <code><a href="get.siggenes.html">get.siggenes</a></code> for details).
</p>
<p>
Basiscally in the function calls subsequent steps of the maSigPro approach which is:
newline qquad Make a general regression model with dummies to indicate different experimental groups.
newline qquad Select significant genes on the basis of this general model, applying fdr control.
newline qquad Find significant variables for each gene, using stepwise regression.
newline qquad Extract and display significant genes for any set of variables or experimental groups.
</p>


<h3>Value</h3>

<table summary="R argblock">
<tr valign="top"><td><code>summary</code></td>
<td>
a vector or matrix listing significant genes for the variables given by the function parameters</td></tr>
<tr valign="top"><td><code>sig.genes</code></td>
<td>
a list with detailed information on the significant genes found for the variables given by the function parameters. Each element of the list is also a list containing:
newline qquad <code>sig.profiles</code>: expression values of significant genes.The cluster assingment of each gene is given in the last column
newline qquad <code>coefficients</code>: regression coefficients for significant genes
newline qquad <code>t.score</code>: value of the t statistics of significant genes
newline qquad <code>sig.pvalues</code>: p-values of the regression coefficients for significant genes
newline qquad <code>g</code>: number of genes
newline qquad ... :arguments passed by previous functions</td></tr>
<tr valign="top"><td><code>input.data </code></td>
<td>
input analysis data</td></tr>
<tr valign="top"><td><code>G</code></td>
<td>
number of input genes</td></tr>
<tr valign="top"><td><code>edesign</code></td>
<td>
matrix of experimental design</td></tr>
<tr valign="top"><td><code>dis</code></td>
<td>
regression design matrix</td></tr>
<tr valign="top"><td><code>min.obs</code></td>
<td>
imputed value for minimal number of true observations</td></tr>
<tr valign="top"><td><code>p.vector</code></td>
<td>
vector containing the computed p-values of the general regression model for each gene</td></tr>
<tr valign="top"><td><code>variables </code></td>
<td>
variables in the general regression model</td></tr>
<tr valign="top"><td><code>g</code></td>
<td>
number of signifant genes</td></tr>
<tr valign="top"><td><code>p.vector.alfa </code></td>
<td>
p-vlaue at FDR = <code>Q</code> control</td></tr>
<tr valign="top"><td><code>step.method</code></td>
<td>
imputed step method for stepwise regression</td></tr>
<tr valign="top"><td><code>Q</code></td>
<td>
imputed value for false discovery rate (FDR) control</td></tr>
<tr valign="top"><td><code>step.alfa</code></td>
<td>
inputed significance level in stepwise regression</td></tr>
<tr valign="top"><td><code>influ.info </code></td>
<td>
data frame of genes containing influencial data</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Ana Conesa, aconesa@ivia.es; María José Nueda, mj.nueda@ua.es
</p>


<h3>References</h3>

<p>
Conesa, A., Nueda M.J., Alberto Ferrer, A., Talón, T. 2005.
maSigPro: a Method to Identify Significant Differential Expression Profiles in Time-Course Microarray Experiments.
</p>


<h3>See Also</h3>

<p>
<code><a href="make.design.matrix.html">make.design.matrix</a></code>, <code><a href="p.vector.html">p.vector</a></code>, <code><a href="T.fit.html">T.fit</a></code>, <code><a href="get.siggenes.html">get.siggenes</a></code>, <code><a href="see.genes.html">see.genes</a></code>
</p>


<h3>Examples</h3>

<pre>

#### GENERATE TIME COURSE DATA
## generate n random gene expression profiles of a data set with 
## one control plus 3 treatments, 3 time points and r replicates per time point.

tc.GENE &lt;- function(n, r,
             var11 = 0.01, var12 = 0.01,var13 = 0.01,
             var21 = 0.01, var22 = 0.01, var23 =0.01,
             var31 = 0.01, var32 = 0.01, var33 = 0.01,
             var41 = 0.01, var42 = 0.01, var43 = 0.01,
             a1 = 0, a2 = 0, a3 = 0, a4 = 0,
             b1 = 0, b2 = 0, b3 = 0, b4 = 0,
             c1 = 0, c2 = 0, c3 = 0, c4 = 0)
{

  tc.dat &lt;- NULL
  for (i in 1:n) {
    Ctl &lt;- c(rnorm(r, a1, var11), rnorm(r, b1, var12), rnorm(r, c1, var13))  # Ctl group
    Tr1 &lt;- c(rnorm(r, a2, var21), rnorm(r, b2, var22), rnorm(r, c2, var23))  # Tr1 group
    Tr2 &lt;- c(rnorm(r, a3, var31), rnorm(r, b3, var32), rnorm(r, c3, var33))  # Tr2 group
    Tr3 &lt;- c(rnorm(r, a4, var41), rnorm(r, b4, var42), rnorm(r, c4, var43))  # Tr3 group
    gene &lt;- c(Ctl, Tr1, Tr2, Tr3)
    tc.dat &lt;- rbind(tc.dat, gene)
  }
  tc.dat
}

## Create 270 flat profiles
flat &lt;- tc.GENE(n = 270, r = 3)
## Create 10 genes with profile differences between Ctl and Tr1 groups
twodiff &lt;- tc.GENE (n = 10, r = 3, b2 = 0.5, c2 = 1.3)
## Create 10 genes with profile differences between Ctl, Tr2, and Tr3 groups
threediff &lt;- tc.GENE(n = 10, r = 3, b3 = 0.8, c3 = -1, a4 = -0.1, b4 = -0.8, c4 = -1.2)
## Create 10 genes with profile differences between Ctl and Tr2 and different variance
vardiff &lt;- tc.GENE(n = 10, r = 3, a3 = 0.7, b3 = 1, c3 = 1.2, var32 = 0.03, var33 = 0.03)
## Create dataset
tc.DATA &lt;- rbind(flat, twodiff, threediff, vardiff)
rownames(tc.DATA) &lt;- paste("feature", c(1:300), sep = "")
colnames(tc.DATA) &lt;- paste("Array", c(1:36), sep = "")
tc.DATA[sample(c(1:(300*36)), 300)] &lt;- NA  # introduce missing values

#### CREATE EXPERIMENTAL DESIGN
Time &lt;- rep(c(rep(c(1:3), each = 3)), 4)
Replicates &lt;- rep(c(1:12), each = 3)
Control &lt;- c(rep(1, 9), rep(0, 27))
Treat1 &lt;- c(rep(0, 9), rep(1, 9), rep(0, 18))
Treat2 &lt;- c(rep(0, 18), rep(1, 9), rep(0,9))
Treat3 &lt;- c(rep(0, 27), rep(1, 9))
edesign &lt;- cbind(Time, Replicates, Control, Treat1, Treat2, Treat3)
rownames(edesign) &lt;- paste("Array", c(1:36), sep = "")

#### RUN maSigPro
tc.test &lt;- maSigPro (tc.DATA, edesign, degree = 2, vars = "groups", main = "Test")

tc.test$g  # gives number of total significant genes
tc.test$summary  # shows significant genes by experimental groups
tc.test$sig.genes$Treat1$sig.pvalues  # shows pvalues of the significant coefficients 
                                      # in the regression models of the significant genes 
                                      # for Control.vs.Treat1 comparison

</pre>



<hr><div align="center">[Package <em>maSigPro</em> version 1.0 <a href="00Index.html">Index]</a></div>

</body></html>
